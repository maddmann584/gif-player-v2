<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Maddmann Device Tools</title>
  <link rel="stylesheet" href="style.css"/>

  <!-- ESP Web Tools -->
  <script type="module" src="https://unpkg.com/esp-web-tools@10/dist/web/install-button.js?module"></script>
</head>
<body>
  <header>
    <h1 id="siteTitle">Maddmann’s Tools</h1>
    <p id="siteSubtitle">Pick a device • Flash firmware • Connect • Upload • Play GIFs</p>
  </header>

  <!-- ✅ START SCREEN -->
  <main id="picker" class="card">
    <h2>Select device</h2>
    <p class="hint">Choose which firmware + uploader mode you want.</p>

    <div class="row">
      <button id="pickCyber" class="pick big">CYBER DECK</button>
      <button id="pickCyd" class="pick big">CYD GIF PLAYER</button>
    </div>

    <div class="hint">
      Tip: You can bookmark the direct links:
      <span class="mono">?device=cyberdeck</span> or <span class="mono">?device=cyd</span>
    </div>
  </main>

  <!-- ✅ APP SCREEN -->
  <main id="app" class="card hidden">
    <div class="row space-between">
      <h2 id="deviceHeader" style="margin:0;">Device</h2>
      <button id="backBtn" class="small">← Change device</button>
    </div>

    <h2>1) Flash firmware</h2>
    <p class="hint">Use Chrome/Edge. Close Arduino Serial Monitor first.</p>
    <div class="row">
      <!-- We set manifest dynamically in JS -->
      <esp-web-install-button id="installBtn"></esp-web-install-button>
    </div>

    <hr class="sep"/>

    <h2>2) Connect</h2>
    <div class="row">
      <button id="connectBtn">Connect</button>
      <span id="status">Not connected</span>
    </div>

    <div class="row">
      <input id="fileInput" type="file" accept=".gif,image/gif"/>
      <button id="uploadBtn" disabled>Upload to /gifs</button>
      <button id="refreshBtn" disabled>Refresh</button>
    </div>

    <div id="uploadStatus" class="hint">Uploads go to /gifs</div>

    <h2>/gifs</h2>
    <div id="list" class="list"></div>

    <pre id="debug" class="debug">Debug:
</pre>
  </main>

  <script src="app.js"></script>
</body>
</html>
